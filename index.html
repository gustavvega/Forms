<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>F√≠sica M√©dica ‚Äì Radiolog√≠a HCG | Hub QA</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0b1220" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <link rel="apple-touch-icon" href="icon.png"> />

  <style>
    :root{
      --bg:#0b1220;
      --card:rgba(255,255,255,.06);
      --line:rgba(255,255,255,.12);
      --text:#eaf0ff;
      --muted:rgba(234,240,255,.70);
      --muted2:rgba(234,240,255,.55);
      --accent1:#5eead4;
      --accent2:#60a5fa;
    }
    body{
      margin:0;
      font-family: Helvetica, Arial, sans-serif;
      background:
        radial-gradient(1200px 600px at 15% 10%, rgba(94,234,212,.18), transparent 55%),
        radial-gradient(900px 520px at 90% 25%, rgba(96,165,250,.18), transparent 55%),
        radial-gradient(700px 420px at 50% 90%, rgba(96,165,250,.10), transparent 55%),
        var(--bg);
      color:var(--text);
      padding:20px;
      box-sizing:border-box;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:flex-start;
    }
    .wrap{ width:100%; max-width:560px; }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:18px;
      backdrop-filter: blur(12px);
      box-shadow: 0 20px 45px rgba(0,0,0,.35);
      overflow:hidden;
      position:relative;
    }
    .card::before{
      content:"";
      position:absolute;
      inset:0;
      background:url('icon-512.png') center center no-repeat;
      background-size:320px;
      opacity:.05;
      pointer-events:none;
    }

    header{
      display:flex;
      gap:12px;
      align-items:center;
      padding:18px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      position:relative;
    }
    header img{ height:44px; width:auto; }
    .title{ line-height:1.2; }
    h1{ margin:0; font-size:16px; font-weight:400; letter-spacing:.2px; }
    .sub{ margin-top:4px; font-size:12px; color:var(--muted); }

    .toolbar{
      padding:14px 18px;
      display:flex;
      flex-direction:column;
      gap:10px;
      position:relative;
    }

    .roles{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
    }
    .pill{
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.08);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      font-weight:400;
      cursor:pointer;
      user-select:none;
      transition:.18s ease;
      display:flex;
      gap:8px;
      align-items:center;
    }
    .pill:hover{ transform:translateY(-1px); border-color:rgba(94,234,212,.30); }
    .pill.active{
      border-color:rgba(94,234,212,.45);
      background:rgba(94,234,212,.16);
    }

    .search{
      width:100%;
      box-sizing:border-box;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.14);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:12px 12px;
      font-size:14px;
      outline:none;
    }
    .search::placeholder{ color:rgba(234,240,255,.55); }

    .content{ padding:6px 18px 18px; position:relative; }

    .section{ margin-top:14px; }
    .section h2{
      margin:0 0 10px 0;
      font-size:11px;
      letter-spacing:.18em;
      text-transform:uppercase;
      color:var(--muted2);
      font-weight:400;
    }

    .btn{
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
      width:100%;
      box-sizing:border-box;
      padding:14px;
      margin:10px 0;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.08);
      color:var(--text);
      text-decoration:none;
      font-size:14px;
      transition:.18s ease;
    }
    .btn:hover{ background:rgba(94,234,212,.18); border-color:rgba(94,234,212,.35); transform:translateY(-1px); }
    .left{ display:flex; align-items:center; gap:10px; min-width:0; }
    .ico{ width:28px; height:28px; display:flex; align-items:center; justify-content:center; border-radius:10px; background:rgba(255,255,255,.07); border:1px solid rgba(255,255,255,.10); flex:0 0 auto; }
    .name{ white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }

    .tag{
      font-size:11px;
      padding:5px 10px;
      border-radius:999px;
      background:linear-gradient(90deg, var(--accent1), var(--accent2));
      color:#0b1220;
      flex:0 0 auto;
    }

    footer{
      padding:12px 18px 16px;
      font-size:11px;
      color:var(--muted2);
      border-top:1px solid rgba(255,255,255,.10);
      background:rgba(0,0,0,.18);
      position:relative;
      line-height:1.35;
    }
    .tiny{ margin-top:6px; color:rgba(234,240,255,.45); }

    .empty{
      padding:18px 0 4px;
      color:rgba(234,240,255,.65);
      font-size:13px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <img src="icon-192.png" alt="CCSS" />
        <div class="title">
          <h1>F√≠sica M√©dica ‚Äì Radiolog√≠a HCG</h1>
          <div class="sub">Hub de formularios QA por rol (Imagenolog√≠a, Ingenier√≠a, F√≠sica M√©dica)</div>
        </div>
      </header>

      <div class="toolbar">
        <div class="roles" id="roles"></div>
        <input class="search" id="q" placeholder="Buscar (ej: CT, Hemo, Aver√≠as, Rayos X, Mamo‚Ä¶)" />
      </div>

      <div class="content" id="content"></div>

      <footer>
        Consejo pr√°ctico: instala como app (Safari ‚Üí Compartir ‚Üí Agregar a pantalla de inicio).
        <div class="tiny">Actualizaci√≥n: cuando crees un nuevo Form, solo agregas un registro en la lista ‚ÄúFORMS‚Äù dentro de este archivo y haces Commit en GitHub.</div>
      </footer>
    </div>
  </div>

  <script>
    // =========================
    // 1) EDITA SOLO ESTA LISTA
    // =========================
    // Campos:
    // - role: 'IMAGENOLOGO' | 'INGENIERO' | 'FISICA'
    // - modality: 'CT' | 'HEMO' | 'RX' | 'MAMO' | 'ING' | 'OTRO'
    // - name: texto del bot√≥n
    // - url: link del Microsoft Form
    // - tag: etiqueta corta (QA / FORM / SOPORTE)
    const FORMS = [
      {
        role: 'FISICA',
        modality: 'CT',
        name: 'QA CT',
        url: 'https://forms.office.com/r/MACe3Zc6Hh?origin=lprLink',
        tag: 'QA'
      },
      {
        role: 'FISICA',
        modality: 'HEMO',
        name: 'QA Hemodinamia',
        url: 'https://forms.office.com/r/Uha8StnjVp?origin=lprLink',
        tag: 'QA'
      },
      {
        role: 'FISICA',
        modality: 'ING',
        name: 'Reporte de Aver√≠as',
        url: 'https://forms.office.com/r/3h11nUW6s3?origin=lprLink',
        tag: 'SOPORTE'
      },
      {
        role: 'IMAGENOLOGO',
        modality: 'HEMO',
        name: 'QA Hemodinamia',
        url: 'https://forms.office.com/r/Uha8StnjVp?origin=lprLink',
        tag: 'QA'
      },
      {
        role: 'IMAGENOLOGO',
        modality: 'ING',
        name: 'Reporte de Aver√≠as',
        url: 'https://forms.office.com/r/3h11nUW6s3?origin=lprLink',
        tag: 'SOPORTE'
      },
      {
        role: 'INGENIERO',
        modality: 'ING',
        name: 'Bit√°cora Ingenieros',
        url: 'https://forms.office.com/r/U7XvyXdeDs?origin=lprLink',
        tag: 'FORM'
      },

      // Ejemplos:
      // { role:'FISICA', modality:'RX', name:'QA RX ‚Äì Sala 1', url:'https://forms.office.com/r/XXXX', tag:'QA' },
    ];

    // =========================
    // 2) ICONOS POR MODALIDAD
    // =========================
    const MODALITY_ICON = {
      CT:   'üß†',
      HEMO: 'ü´Ä',
      RX:   'ü©ª',
      MAMO: 'üéóÔ∏è',
      ING:  'üõ†Ô∏è',
      OTRO: 'üìã'
    };

    const ROLE_DEF = [
      { id:'IMAGENOLOGO', label:'Imagen√≥logo', icon:'üßë‚Äç‚öïÔ∏è' },
      { id:'INGENIERO',   label:'Ingeniero Servicio', icon:'üß∞' },
      { id:'FISICA',      label:'F√≠sica M√©dica', icon:'üìê' },
    ];

    // Orden sugerido de secciones
    const MODALITY_ORDER = ['CT','HEMO','RX','MAMO','ING','OTRO'];

    // =========================
    // RENDER
    // =========================
    const rolesEl = document.getElementById('roles');
    const contentEl = document.getElementById('content');
    const qEl = document.getElementById('q');

    let activeRole = 'IMAGENOLOGO';

    function renderRoles(){
      rolesEl.innerHTML = '';
      ROLE_DEF.forEach(r => {
        const b = document.createElement('div');
        b.className = 'pill' + (r.id === activeRole ? ' active' : '');
        b.innerHTML = `<span>${r.icon}</span><span>${r.label}</span>`;
        b.addEventListener('click', () => {
          activeRole = r.id;
          renderRoles();
          renderContent();
        });
        rolesEl.appendChild(b);
      });
    }

    function norm(s){
      // Quita acentos para b√∫squeda
      return (s||'')
        .toString()
        .toLowerCase()
        .normalize('NFD')
        .replace(/[\u0300-\u036f]/g, '');
    }

    function groupByModality(items){
      const map = new Map();
      items.forEach(it => {
        const m = it.modality || 'OTRO';
        if(!map.has(m)) map.set(m, []);
        map.get(m).push(it);
      });
      const entries = Array.from(map.entries()).sort((a,b) => {
        const ia = MODALITY_ORDER.indexOf(a[0]);
        const ib = MODALITY_ORDER.indexOf(b[0]);
        return (ia===-1?999:ia) - (ib===-1?999:ib);
      });
      return entries;
    }

    function renderContent(){
      const query = norm(qEl.value);
      const filtered = FORMS
        .filter(f => f.role === activeRole)
        .filter(f => {
          if(!query) return true;
          return [f.name, f.modality, f.tag].some(x => norm(x).includes(query));
        });

      contentEl.innerHTML = '';

      if(filtered.length === 0){
        const d = document.createElement('div');
        d.className = 'empty';
        d.textContent = 'No hay formularios que coincidan con este filtro.';
        contentEl.appendChild(d);
        return;
      }

      const groups = groupByModality(filtered);
      groups.forEach(([mod, items]) => {
        const section = document.createElement('div');
        section.className = 'section';
        const h2 = document.createElement('h2');
        const label = mod === 'ING' ? 'Soporte / Ingenier√≠a' : mod;
        h2.textContent = label;
        section.appendChild(h2);

        items.sort((a,b) => (a.name||'').localeCompare(b.name||''));

        items.forEach(f => {
          const a = document.createElement('a');
          a.className = 'btn';
          a.href = f.url;
          a.rel = 'noopener';

          const ico = MODALITY_ICON[f.modality] || MODALITY_ICON.OTRO;
          a.innerHTML = `
            <span class="left">
              <span class="ico">${ico}</span>
              <span class="name">${f.name}</span>
            </span>
            <span class="tag">${f.tag || 'FORM'}</span>
          `;
          section.appendChild(a);
        });

        contentEl.appendChild(section);
      });
    }

    qEl.addEventListener('input', renderContent);

    renderRoles();
    renderContent();

    // PWA service worker
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(()=>{});
      });
    }
  </script>
</body>
</html>
